{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://e-rihs.io/schema/kpi-definition-v0.4.schema.json",
    "title": "E-RIHS KPI Definition",
    "type": "object",
    "required": [
        "id",
        "title"
    ],
    "properties": {
        "id": {
            "title": "E-RIHS PID",
            "type": "string",
            "cordra": {
                "type": {
                    "autoGeneratedField": "handle"
                }
            }
        },
        "title": {
            "title": "Title",
            "type": "string",
            "cordra": {
                "preview": {
                    "showInPreview": true,
                    "isPrimary": true
                }
            }
        },
        "subjects": {
            "title": "Measured subjects",
            "type": "array",
            "format": "textarea",
            "description": "PIDs of the subjects that are measured by this KPI.",
            "items": {
                "type": "string"
            }
        },
        "description": {
            "title": "Description",
            "type": "string",
            "description": "A brief description of the purpose of the KPI and the sources of information it is based on. Details of specific calculations will be recorded within the 'formula' field.",
            "cordra": {
                "preview": {
                    "showInPreview": true,
                    "excludeTitle": true
                }
            }
        },
        "target_metrics": {
            "title": "Target metrics",
            "type": "array",
            "description": "Target metrics for the KPI (that will be used for evaluation).",
            "items": {
                "type": "object",
                "required": [
                    "key",
                    "value",
                    "metric_check"
                ],
                "properties": {
                    "key": {
                        "title": "Key",
                        "type": "string",
                        "description": "The key of the target metric"
                    },
                    "value": {
                        "title": "Value",
                        "description": "The value of the target metric"
                    },
                    "unit": {
                        "title": "Unit",
                        "type": "string",
                        "description": "The unit of the target metric"
                    },
                    "metric_check": {
                        "title": "Metric check",
                        "type": "string",
                        "description": "The metric check to be used for evaluation",
                        "enum": [
                            "Exists",
                            "Is equal",
                            "Is not equal",
                            "Is greater than",
                            "Is greater than or equal",
                            "Is less than",
                            "Is less than or equal",
                            "Is true",
                            "Is false"
                        ]
                    }
                }
            }
        },
        "access_level": {
            "title": "Access level",
            "type": "string",
            "description": "The level of access on which the KPI score or value is relevant - Global, EU - E-RIHS, National - French, National - Greek, Institutional - National Gallery, Personal etc."
        },
        "time_period": {
            "title": "Time period or event",
            "type": "string",
            "description": "The time period or the event the KPI is relevant to.",
            "enum": [
                "Project",
                "Access",
                "Examination",
                "Year",
                "Month",
                "Week",
                "Day",
                "Hour"
            ]
        },
        "function": {
            "title": "Function",
            "type": "string",
            "format": "textarea",
            "description": "The KPI function is a machine readable description of how the values for a given KPI are gathered or calculated, either from the local database or from external services. It is expected to take the form of a script, programming function, database query or a URL."
        }
    }
}