{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$id": "https://e-rihs.io/schema/service-v1.0.schema.json",
    "$code": "4b54",
    "title": "Service",
    "type": "object",
    "required": [
        "title",
        "summary",
        "description",
        "readiness_level",
        "methods",
        "application_required",
        "team_members",
        "access_unit",
        "service_active",
        "research_disciplines",
        "categories",
        "functions"
    ],
    "properties": {
        "$schema": {
            "type": "string",
            "options": {
                "hidden": true
            }
        },
        "id": {
            "type": "string",
            "cordra": {
                "type": {
                    "autoGeneratedField": "handle"
                }
            }
        },
        "title": {
            "title": "Title",
            "description": "Service title. For an ARCHLAB service, this could be e.g. 'Access to KIK-IRPA Archives', for the other platforms, this could be the name of the technique.",
            "type": "string",
            "minLength": 3,
            "maxLength": 100,
            "cordra": {
                "preview": {
                    "showInPreview": true,
                    "isPrimary": true
                }
            }
        },
        "summary": {
            "title": "Service Summary",
            "description": "A brief description of a specific technical or access service offered, such as the use of X to investigate Y",
            "type": "string",
            "format": "textarea",
            "minLength": 3,
            "maxLength": 512,
            "cordra": {
                "preview": {
                    "showInPreview": true
                }
            }
        },
        "description": {
            "title": "Service Description",
            "type": "string",
            "format": "textarea",
            "description": "A longer description/documentation of a specific technical or access service offered under E-RIHS"
        },
        "readiness_level": {
            "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/readiness_level"
        },
        "operating_languages": {
            "title": "Operating Languages",
            "description": "What languages can the team operate in or what language is a tool presented in",
            "type": "array",
            "items": {
                "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/operating_language"
            }
        },
        "support_activities": {
            "title": "Support Activities",
            "type": "array",
            "items": {
                "title": "Support Activity",
                "type": "object",
                "properties": {
                    "type": {
                        "title": "Support types",
                        "type": "array",
                        "items": {
                            "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/support_type"
                        }
                    },
                    "provider": {
                        "title": "Support Provider",
                        "description": "PID of the support provider",
                        "type": "string",
                        "cordra": {
                            "type": {
                                "handleReference": {
                                    "types": ["Organisation"]
                                }
                            }
                        }
                    },
                    "summary": {
                        "title": "Summary of the support",
                        "description": "General description of the support or any required caption/citation",
                        "type": "string",
                        "format": "textarea"
                    },
                    "start_date": {
                        "title": "Start date",
                        "description": "When did the support begin",
                        "type": "string",
                        "format": "date"
                    },
                    "end_date": {
                        "title": "End date",
                        "description": "When did the support end (optional)",
                        "type": "string",
                        "format": "date"
                    }
                },
                "required": ["type", "provider", "start_date"]
            }
        },
        "techniques": {
            "title": "Service Techniques",
            "description": "A list of the individual relevant heritage science examination and analytical techniques carried out within this Service. If none of the techniques is applicable, use the 'Other service techniques' below. Even though ARCHLAB services are usually not linked to specific techniques, equipment or software, their archives contain data that were obtained in the past using various techniques. Sometimes, existing samples in the archives can be re-analysed using contemporary techniques. In such cases, both these techniques could be listed here.",
            "type": "array",
            "items": {
                "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/technique"
            }
        },
        "techniques_other": {
            "title": "Other Service Techniques",
            "description": "Other (unlisted) individual relevant heritage science examination and analytical techniques carried out within this Service (free text).",
            "type": "array",
            "items": {
                "title": "Technique",
                "type": "string"
            }
        },
        "e-rihs_platform": {
            "title": "E-RIHS Platform",
            "description": "E-RIHS platform code",
            "type": "array",
            "items": {
                "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/e-rihs_platform"
            }
        },
        "application_required": {
            "title": "Application required",
            "description": "Is an application for access required",
            "type": "boolean",
            "format": "checkbox",
            "default": true
        },
        "providers": {
            "title": "Service Providers",
            "type": "array",
            "format": "table",
            "minLength": 1,
            "items": {
                "title": "Service Provider",
                "type": "object",
                "required": ["provider_id", "provider_role"],
                "properties": {
                    "provider_id": {
                        "title": "Provider ID",
                        "description": "An actor (organisation or person) offering this service, as defined in the system.",
                        "type": "string",
                        "cordra": {
                            "type": {
                                "handleReference": {
                                    "types": ["Organisation", "Person"]
                                }
                            }
                        }
                    },
                    "provider_role": {
                        "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/provider_role"
                    }
                }
            }
        },
        "contacts": {
            "title": "Service Contacts",
            "description": "Contact details for the service; this can be personal or group contact details.",
            "type": "array",
            "format": "table",
            "minLength": 1,
            "items": {
                "title": "Service Contact",
                "type": "object",
                "properties": {
                    "type": {
                        "type": "string",
                        "enum": ["E-mail", "Phone"]
                    },
                    "contact": {
                        "title": "Contact",
                        "description": "E-mail or phone number",
                        "type": "string"
                    }
                }
            }
        },
        "research_disciplines": {
            "title": "Research Disciplines",
            "description": "Which domains or disciplines has a given service worked within, has experience within. This field is connected to an extensive controlled list.",
            "type": "array",
            "minItems": 1,
            "items": {
                "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/research_discipline"
            }
        },
        "research_disciplines_narrower": {
            "title": "Research Disciplines (narrower/other)",
            "description": "More precise description of the domains or disciplines a given service has worked within or has experience within (free text).",
            "type": "array",
            "items": {
                "title": "Research Discipline",
                "type": "string"
            }
        },
        "categories": {
            "title": "Service Categories",
            "description": "Short and descriptive categories of service provision, e.g. 'Identification of Inorganic Pigments', 'Analysis of Archaeological Pottery', 'Classification of Ancient Organic Material', 'Online Preventive Conservation Tool' or 'Collection Management Tool'. At the moment, these are free text but will likely be replaced with a controlled list",
            "type": "array",
            "minItems": 1,
            "items": {
                "title": "Category",
                "type": "string"
            }
        },
        "functions": {
            "title": "Service Functions",
            "description": "Short and descriptive service practical level activities, what has a service been used for, what is it intended for. E.g. 'Materials Analysis', 'Dye Analysis', 'De-convolution XRF Spectra', 'Calculating Light Exposure Allowance'. At the moment, these are free text but will likely be replaced with a controlled list.",
            "type": "array",
            "minItems": 1,
            "items": {
                "title": "Function",
                "type": "string"
            }
        },
        "methods": {
            "title": "Method statements for the activities in the service",
            "description": "Service related method statements should be defined in the system and represent the procedures for using individual pieces of equipment or software systems used within the service - detail of setup, methodology, procedures, etc. should all be described within this document and is also directly attached to relevant the Tool (equipment or software) records.",
            "type": "array",
            "minItems": 1,
            "items": {
                "title": "Method",
                "type": "string",
                "cordra": {
                    "type": {
                        "handleReference": {
                            "types": ["Method"]
                        }
                    }
                }
            }
        },
        "measurable_properties": {
            "title": "Measurable properties",
            "description": "Measurable properties and materials that can be studied by this service",
            "type": "array",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
                "title": "Measurable property",
                "type": "object",
                "required": ["class"],
                "properties": {
                    "class": {
                        "title": "Measurable property class",
                        "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/measurable_property"
                    },
                    "materials": {
                        "title": "Materials",
                        "description": "Materials of which the selected measurable property can be studied. This field is connected to an extensive controlled list.",
                        "type": "array",
                        "items": {
                            "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/material"
                        }
                    },
                    "materials_other": {
                        "title": "Other materials",
                        "description": "Other materials of which the selected measurable property can be studied (free text)",
                        "type": "array",
                        "items": {
                            "title": "Material",
                            "type": "string"
                        }
                    }
                }
            }
        },
        "resources": {
            "title": "Collections, Objects, Samples and Archives",
            "description": "Research resources made accessible by the service should be defined in the system and represent the heritage collections, objects, samples, archives, other research resources directly provided by the service.",
            "type": "array",
            "items": {
                "anyOf": [
                    {
                        "title": "Resource (description)",
                        "type": "string",
                        "format": "textarea"
                    },
                    {
                        "title": "Resource (link, PID)",
                        "type": "string",
                        "format": "uri"
                    }
                ]
            }
        },
        "limitations": {
            "title": "Service Limitations",
            "type": "string",
            "format": "textarea",
            "description": "Description of any limitations in the access provision by the service."
        },
        "team_members": {
            "title": "Team",
            "type": "array",
            "minLength": 1,
            "items": {
                "title": "Team member",
                "type": "object",
                "required": ["team_member_id", "roles", "start_date"],
                "properties": {
                    "team_member_id": {
                        "title": "Person ID",
                        "description": "An actor as defined in the system",
                        "type": "string",
                        "cordra": {
                            "type": {
                                "handleReference": {
                                    "types": ["Person"]
                                }
                            }
                        }
                    },
                    "roles": {
                        "title": "Person Roles",
                        "description": "What are the roles this person has in the team working on this service. This field is connected to a controlled list.",
                        "type": "array",
                        "items": {
                            "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/person_role"
                        }
                    },
                    "start_date": {
                        "title": "Joined service date",
                        "description": "A date to indicate when a given person joined the team working on a given service.",
                        "type": "string",
                        "format": "date"
                    },
                    "end_date": {
                        "title": "Left service date",
                        "description": "A date to indicate when a given person left the team working on a given service.",
                        "type": "string",
                        "format": "date"
                    }
                }
            }
        },
        "links": {
            "title": "Service Links",
            "type": "array",
            "minLength": 1,
            "format": "table",
            "items": {
                "title": "Link",
                "type": "object",
                "required": ["url", "type"],
                "properties": {
                    "url": {
                        "title": "Link URL",
                        "description": "A related resolvable URL not covered by the other fields",
                        "type": "string",
                        "format": "uri"
                    },
                    "type": {
                        "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/link_type"
                    }
                }
            }
        },
        "references": {
            "title": "References",
            "description": "References related to the service",
            "type": "array",
            "items": {
                "title": "Reference",
                "type": "object",
                "required": ["citation"],
                "properties": {
                    "citation": {
                        "title": "Citation",
                        "description": "The formatted details for the given reference.",
                        "type": "string"
                    },
                    "url": {
                        "title": "URL",
                        "description": "URL",
                        "type": "string",
                        "format": "uri"
                    },
                    "role": {
                        "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/reference_role"
                    }
                }
            }
        },
        "example_outputs": {
            "title": "Example output datasets",
            "description": "Services that generate data can provide PIDs/URLs for example datasets to demonstrate what types of data and information will be created.",
            "type": "array",
            "items": {
                "title": "Dataset",
                "type": "string",
                "format": "uri"
            }
        },
        "example_inputs": {
            "title": "Example input datasets",
            "description": "Services that process data can provide PIDs/URLs for example datasets to demonstrate what data and formats are required for the Service to run.",
            "type": "array",
            "items": {
                "title": "Dataset",
                "type": "string",
                "format": "uri"
            }
        },
        "version": {
            "title": "Service Version",
            "description": "Service develop over time with changes of equipment, software, personnel, etc. Version numbers should be changed to indicate these changes - please note very large scale changes may warrant the creation of a new Service record to clarify differences in the data or results created.",
            "type": "string"
        },
        "version_date": {
            "title": "Service Version Date",
            "description": "The version date is the date from which this particular version of this Service was offered in a formal capacity by the defined Access provider.",
            "type": "string",
            "format": "date"
        },
        "creation_date": {
            "title": "Service Creation Date",
            "description": "The creation date is the date from which this particular Service was offered in a formal capacity by the defined Access provider.",
            "type": "string",
            "format": "date"
        },
        "dmp": {
            "title": "Service Data Management Plan",
            "description": "An open description of the data management procedures followed with the defined service, including licence issues, preferred data repositories, publication embargoes, common file formats, software and systems used, etc.",
            "anyOf": [
                {
                    "title": "Reference to external documents",
                    "type": "object",
                    "properties": {
                        "citation": {
                            "title": "Citation",
                            "description": "The formatted details for the given reference.",
                            "type": "string"
                        },
                        "url": {
                            "title": "URL",
                            "description": "URL",
                            "type": "string",
                            "format": "uri"
                        }
                    }
                },
                {
                    "title": "Textual description",
                    "type": "string",
                    "format": "textarea"
                }
            ]
        },
        "dmp_variation": {
            "title": "Variation from E-RIHS DMP",
            "type": "string",
            "format": "textarea",
            "description": "Description of any required data management differences that may be required for the service, in relation to national, funding or institutional limitations; some differences could be easily manageable but other might require updates to the E-RIHS DMP."
        },
        "dataflow_description": {
            "title": "Dataflow description",
            "description": "A reference to a diagram or written description of the dataflow. More complex services, multiple pieces of equipment or data processing steps, might benefit for a summary description of the key stages, including details of any required background information, direct input from users and any processing steps.",
            "type": "object",
            "properties": {
                "citation": {
                    "title": "Citation",
                    "description": "The formatted details for the given reference.",
                    "type": "string"
                },
                "url": {
                    "title": "URL",
                    "description": "URL",
                    "type": "string",
                    "format": "uri"
                }
            }
        },
        "output_description": {
            "title": "Service Output Description",
            "type": "string",
            "format": "textarea",
            "description": "A description of all of the raw and processes outputs created by a given services including details of how they relate to or rely on each other."
        },
        "input_description": {
            "title": "Service Input Description",
            "type": "string",
            "format": "textarea",
            "description": "A description of the required formats or files required for any service which processes existing data."
        },
        "further_comments": {
            "title": "Other Comments",
            "type": "string",
            "format": "textarea",
            "description": "Free text opportunity to advocate for what is novel or special about this particular access"
        },
        "keywords": {
            "title": "Service keywords",
            "description": "Additional terms and concepts not covered by the other fields",
            "type": "array",
            "items": {
                "title": "Keyword",
                "type": "string"
            }
        },
        "access_unit": {
            "title": "Service Access Period Unit",
            "description": "For previously defined services this has commonly been defined in days or occasionally hours - but with the development of digital services additional smaller time units might be needed.",
            "$ref": "https://e-rihs.io/schema/controlled_lists.schema.json#/definitions/period_unit"
        },
        "hours_per_unit": {
            "title": "Service Access Hours per Unit",
            "description": "Access units are described as time periods, but depending on the nature of a service this might relate to a range of different periods of activity time. For example a day could relate to a working day or a calendar day, a digital service could relate to run time or processing time. So this value is used to relate actual activity time to the recorded access unit. This value is only required in case of ambiguous access unit types. Use '0' if not applicable.",
            "type": "number"
        },
        "access_unit_cost": {
            "title": "Service Access Unit Cost",
            "description": "Service offered under E-RIHS can include a unit cost in Euro. This cost is expected to represent a proportion of the actual cost of providing a given Service ranging from zero to the full actual cost of providing the service. Access service costs will be based on potentially discounted actual costs and may not include any for-porfit contributions",
            "type": "number"
        },
        "service_active": {
            "title": "Active service",
            "description": "Is the service currently open for access?",
            "type": "boolean",
            "format": "checkbox",
            "default": true
        }
    }
}
